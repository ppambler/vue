| ✍️ Tangxt | ⏳ 2020-07-22 | 🏷️ 技巧 |

# 10-Vue 的常用技巧

> 文档不会说的内容

## ★ `v-model` 不是双向绑定

1）React 和 Vue 的区别是什么？

经典答法：

> React 是单向数据流，而 Vue 则是双向绑定的

不过，这个答案是错的，但是你就是可以这样回答！ -> 因为使用 React 的人，对 Vue 的了解，肯定是停留在以前的 Vue ，以前的 Vue 确实是双向绑定，但是现在的 Vue 是咩有双向绑定的，全部都是单向的

总之，去一个 React 的公司就告诉他，Vue 是双向绑定的，React 是单向绑定的，反之，去一个 Vue 的公司，就告诉他「Vue 1 是以双向绑定为主的，而 Vue 2 逐渐地就使用单向数据流了，而`v-model`是语法糖 」 -> 对不同的公司给出的答案是不一样的！

2）信息点

1、`v-model`不是双向绑定，它是在骗你的，其本质是个语法糖 

`input` & `#app` 的关系就像是子组件与父组件一样

![v-model 的本质](assets/img/2020-07-22-13-21-11.png)

> 在`#app`这个区域看到的变量、表达式啥的，都是`#app`这个父组件的数据哈！ -> `input`这个子组件内部会触发`input`事件，并把用户输入的`value`带上来给父组件，父组件会监听到这个事件，所以`$event.target.value`的值就是用户输入的`value`，`msg2 = value`就是在改父组件的`msg2`的值，这个`msg2`一变化，就会响应到`:value="msg2"`

2、能让你出现`bug`的测试

Vue 记不住光标的位置：

![bug](assets/img/2020-07-22-23-05-30.png)

DOM 变化情况：

![view](assets/img/2020-07-22-23-07-33.png)

可以看到，所谓的「双向绑定」其实是单向的……即 用户在页面上改 DOM -> 事件 -> `msg2 = 用户输入的值` -> DOM 更新……注意这是跨父子组件的更新！而不是子组件的更新，直接就反映在子组件的 DOM 上了……如果真这样，那才是真正意义上的「双向绑定」！

> 话说，`$event.target`指的是不是那个触发事件的元素，如上边的`span`元素！ -> `e.currentTarget`始终是监听事件者（`xxx.addEventListener()`），而`e.target`是事件的真正发出者（**触发事件的那个元素**）

3）Vue 的「双向绑定」 `v-model`

从 Vue 0.x 开始，Vue 就用 `v-model`来实现「双向绑定」。

如：

```
data: {
  user: { name: 'xxx'}
}
<input v-model="user.name">
```

能实现以下两个绑定：

1. `user.name` 的变化自动同步到 `input.value`
2. `input.value` 的变化自动同步到 `user.name`

## ★豪车与嫩模

1）双向绑定的不好之处

用户改了数据，就会立刻生效 -> 数据是不受控制的！

![双向绑定不好之处](assets/img/2020-07-23-01-09-37.png)

而单向数据流则可以：

- 数据拥有者（哪个组件拥有`data`）清楚地知道数据变化的原因和时机（因为是它自己操作数据的）
- 数据拥有者可以阻止数据变化

就像是 React 那样可以阻止用户对表单直接输入那样……

形象点来说：

![双向绑定](assets/img/2020-07-23-01-22-17.png)

![单向绑定](assets/img/2020-07-23-01-27-51.png)

> 注意，以前的双向绑定是真得双向绑定啊！没有什么事件在改`data`之前杵着，你往`input`里输入数据，就会立即改内存里的`data`，中间不带喘气的，而现在的`v-model`你看起来以为是双向绑定，但其实并不是啊！也是单向数据流呀！ -> Vue 现在是通过两个单向绑定（`:value="xxx"`「**父到子传数据**」和`@input="xxx = $event.target.value"`「**子到父传数据**」）来模拟双向绑定呀！即 Vue 的双向绑定是假的双向绑定，所以这就是为啥我们可以拦截数据的原因！

2）三种写法





