| ✍️ Tangxt | ⏳ 2020-07-30 | 🏷️ vuex |

# 12-状态管理与Vuex

## ★概述

1. 状态是什么
2. 状态管理是什么
3. Vuex 用法

> 讲状态管理的原理以及最常用的状态管理 vuex 的使用！

## ★状态管理是啥？

> 了解「状态管理」需要拆开来看 -> 「什么是状态」+「什么是状态管理」

1）什么是状态？

![image-20200731130013032](assets/img/image-20200731130013032.png)

举例来说：

![image-20200731130527080](assets/img/image-20200731130527080.png)

2）如何对状态进行管理？

我们写一个组件是这样的：

![image-20200731131030607](assets/img/image-20200731131030607.png)

我们写一个父子组件是这样的：

![image-20200731131350759](assets/img/image-20200731131350759.png)

**父子之间是如何通信的？**

![image-20200731132422615](assets/img/image-20200731132422615.png)

然而这种通信方式「**耦合**」了（设计的东西有依赖）！  -> 为什么这么说呢？ -> 如果我们不用 `g-button`，用的是 `el-button`，那么你能保证 `el-button`里边是否有元素被绑定了 `click`事件呢？如果没有，那么我们写的 `@hi`就是个笑话！ -> 对于React 来说，会经常性地传个 `onClick`参数！

那么我们该如何解耦呢？（**解决耦合的问题就叫做解耦**）

**爷父孙通信？**

![image-20200731155519294](assets/img/image-20200731155519294.png)

> 我们 `@click`实际上就是在 `this.$on('click',callback)`

为啥需要 `eventBus`？

因为它是个 `new Vue()`，`$on` 和 `$emit` 这两个方法，有了它之后，组件之间消息的传递就不用那么手递手重复这样麻烦了……

![image-20200731160647120](assets/img/image-20200731160647120.png)

话又说回来，我们的状态 `n` 只在 `grandfather` 上，可假如其兄弟上也要一个 `n` 呢？

> 那就把 `n` 状态的存放位置抬高一级呗！ -> 让 `n`永远站在食物链的顶端

![image-20200731162524383](assets/img/image-20200731162524383.png)



单向数据流就是自上而下流动数据，对于 Vue、React来说，顶级 `n` 变了，次级依赖的 `n`也会随着发生响应式的变更，而其它框架可能需要手动做一些处理！

然而，单向数据流也是有缺点的

> 我们知道事件沟通 `emit('click')` 只需要一次，事件监听 `on('click')` 也只需要一次，但是数据的单向数据流传递处处都需要写代码，即有几个组件用到`n`，那么你就得传几次 `n`

![image-20200731163832131](assets/img/image-20200731163832131.png)

还有假如，如只有一处地方用到`n`呢？

![image-20200731164556683](assets/img/image-20200731164556683.png)

清空自己之前的认识

我们知道事件传递可以通过 `eventHub` 来搞，这样一条线上即便存在几百个节点，沟通起来也挺方便的！

![image-20200731165329174](assets/img/image-20200731165329174.png)

那么是否有 `dataHub`呢？

目前我们的事件传递变迁是这样的：

![image-20200731170012278](assets/img/image-20200731170012278.png)

同理，我们对 `n` 也来一次 `Hub` 的操作：

![image-20200731170500294](assets/img/image-20200731170500294.png)

话说，`X` 代表什么呢？ -> 就是 `Store` 啦！

所有的数据管理都会有个`Store`，而 Store 就是存储东西的地方！一般存储的地方叫做柜台，用来收钱，而这是商店，所以 Store 又有商店的意思！

所以这就是为啥 vuex 有个最重要的概念——你必须有一个全局的 Store

就跟 EventBus 一样，为啥一定要有一个全局的 EventBus 呢？ -> 因为用它来**专门负责事件管理**呀！

而 Store 则是**专门负责数据管理**！

一旦有了 Store，你就不用操心数据的读和写的问题了！ -> 你直接把数据放到 Store 里边去，要读时，就调用 Store 的读API，要写时，就调用 Store 的写API

目前，关于 Store 的这两个读写API，我们并不知道叫啥名字……

话又说回来，为啥方方要翻译那篇「停止学习框架」呢？

因为很有可能这些复杂的问题，你只需要在大脑里边把它们的结构画清楚，然后再画几个箭头就搞清楚了！

这节课要告诉你的是：

- 所有框架的核心都是一些很基本的名字，比如说「事件传递」、「数据传递」 -> 如果你的组件是树形结构的，不管是 Vue 、React 还是 Angular，都是一样的方法套路，即总会有个中介代理（叫啥无所谓），在那个特定的位置杵着……

## ★Vuex的store













