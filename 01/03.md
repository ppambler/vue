| âœï¸ Tangxt | â³ 2020-07-11 | ğŸ·ï¸ æ•°æ®å“åº”å¼ |

# 03-æ•°æ®å“åº”å¼

## â˜…å‰è¨€

äº†è§£ã€Œæ•°æ®å“åº”å¼ã€å‰ï¼Œæˆ‘çœ‹äº† vue å®˜ç½‘çš„è¿™ç¯‡ä»‹ç»ï¼š

[æ·±å…¥å“åº”å¼åŸç† â€” Vue.js](https://cn.vuejs.org/v2/guide/reactivity.html)

ä½†æˆ‘çœ‹å¾—äº‘é‡Œé›¾é‡Œçš„â€¦â€¦

æ ¹æ®å®˜ç½‘æ¨èçš„è§†é¢‘ï¼ˆçº¯è‹±æ–‡çš„è§†é¢‘å®åœ¨æ˜¯å¬ä¸æ‡‚ï¼‰ï¼Œæˆ‘å¤§æ¦‚çœ‹äº†ä¸€ä¸‹è§†é¢‘ä¸‹æ–¹çš„è¿™ç¯‡æ–‡ç« ï¼š

[Build a Reactivity System - Advanced Components - Vue Mastery](https://www.vuemastery.com/courses/advanced-components/build-a-reactivity-system/)

å…¶ä¸­æåˆ°ï¼š

- JavaScript is procedural, not reactive -> ä½ æƒ³ã€Œreactiveã€ï¼Œé‚£ä¹ˆå°±éœ€è¦äº‹ä»¶ç»‘å®šï¼Œä½†æœ‰`data`äº‹ä»¶å—ï¼Ÿ -> æ‰€ä»¥è¿™å°±æ˜¯ä¸ºå•¥ä¼šæœ‰ã€Œæ•°æ®ç»‘å®šã€çš„ç§°å‘¼ï¼Ÿ -> æ•°æ®æ›´æ–°ç›¸å½“äºæ˜¯è§¦å‘äº‹ä»¶ï¼Œäº‹ä»¶çš„reactiveæ˜¯è§†å›¾å‘ç”Ÿç›¸åº”çš„æ›´æ–°â€¦â€¦
- æŠŠä¸€æ®µä»£ç å­˜å‚¨èµ·æ¥ï¼Œå½“ `data` å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå†æ¬¡è¿è¡Œè¿™æ®µå­˜å‚¨èµ·æ¥çš„çš„ä»£ç ï¼
- è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆ**åœ¨xxxå­˜å‚¨é‡Œè¾¹åŒ¿åå‡½æ•° -> é€šçŸ¥xxxé‡Œè¾¹æ‰€æœ‰çš„åŒ¿åå‡½æ•° -> ä½ ä»¬è¿™äº›åŒ¿åå‡½æ•°éƒ½è·‘ä¸€éå§ï¼**ï¼‰
  - `record` -> `depend` -> è®°å½• -> è®°å½•æ›´æ–°`data`çš„è®¡ç®—è§„åˆ™
  - `storage` -> `subscribers` -> `[]` -> å­˜å‚¨åŒ¿åå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨è®°å½•çš„è§„åˆ™ï¼Œæ³¨æ„ï¼Œè§„åˆ™æ˜¯å»é‡çš„â€¦â€¦
  - `reply` -> `notify` -> å›æ”¾ ->æ‰§è¡Œè®¡ç®—è§„åˆ™
- æ ¹æ®åŒ¿åå‡½æ•°çš„è®¡ç®—è§„åˆ™ï¼ŒåŒ¿åå‡½æ•°å¯èƒ½è§‚å¯Ÿ1ä¸ª`data`å±æ€§æˆ–2ä¸ª`data`å±æ€§æˆ–3ä¸ªâ€¦â€¦å¦‚åŒ¿åå‡½æ•°`A`çš„è®¡ç®—è§„åˆ™æ˜¯ `data.price * 0.8`ï¼Œé‚£ä¹ˆ`A`åª`watcher`ä¸€ä¸ª`data.price`ï¼Œå†æ¯”å¦‚åŒ¿åå‡½æ•°`B`çš„è®¡ç®—è§„åˆ™æ˜¯ `data.price * data.quantity`ï¼Œé‚£ä¹ˆ `B` å¾— `watcher` ä¸¤ä¸ªçŠ¶æ€ï¼Œå³`data.price`å’Œ`data.quantity`
- è®¿é—®`data`å±æ€§ï¼ˆå¦‚`price` or `quantity`ï¼‰æ—¶ï¼Œå­˜å‚¨åŒ¿åå‡½æ•°åˆ°`subscriber`æ•°ç»„ -> æ›´æ–°`data`å±æ€§ï¼Œè¿è¡Œå­˜å‚¨åœ¨`subscriber`é‡Œè¾¹çš„åŒ¿åå‡½æ•°ï¼ -> æ–¹æ¡ˆ`Object.defineProperty()`
- ä¸ºå•¥åœ¨ä½¿ç”¨`Object.defineProperty()` æ—¶è¦å®šä¹‰ä¸€ä¸ªå…¨å±€çš„ `internalValue`å‘¢ï¼Ÿ
  
  ![çˆ†æ ˆ](assets/img/2020-07-11-13-33-43.png)
  
- **Price accessed (get)** => call `dep.depend()` to save the current `target`
- **Price set** => call `dep.notify()` on price, re-running all the `targets`

> è¿™ç¯‡æ–‡ç« çœŸå¾—å†™å¾—å¾ˆå¥½å‘€ï¼ä»æœ€åŸå§‹åˆ°æœ€ç»ˆçš„ç»“æœï¼Œæ˜¯ä¸€æ­¥æ­¥èµ°è¿‡æ¥çš„ï¼Œæˆ‘çœ‹è¿‡ä¸€äº›è®² Vue å“åº”å¼åŸç†çš„æ–‡ç« ï¼Œç›´æ¥ä¸€ä¸Šæ¥å°±æ˜¯`Object.defineProperty()`ï¼Œæ²¡æœ‰ä¸æ¯«çš„é“ºå«è¿‡ç¨‹â€¦â€¦

å†çœ‹è¿™å¼ å›¾ï¼Œæˆ‘ä¸ç¡®å®šè‡ªå·±çš„ç†è§£æ˜¯å¦æ­£ç¡®ï¼š

![æ·±å…¥å“åº”å¼åŸç†](assets/img/2020-07-11-14-43-00.png)

---

## â˜…`getter` å’Œ `setter`

> Vue å¯¹ `data` åšäº†ä»€ä¹ˆï¼Ÿ

1ï¼‰ä¸€å¼ ã€Œå†…å­˜å›¾ã€è´¯ç©¿ä½ æ•´ä¸ªå¯¹ Vue çš„å­¦ä¹ 

![å†…å­˜å›¾](assets/img/2020-07-12-00-12-14.png)

2ï¼‰ä¸ºä»€ä¹ˆæ–¹æ–¹è¦ç”¨ä¸€èŠ‚è¯¾çš„æ—¶é—´æ¥è®²è¿™ä¸ªçœ‹ä¼¼å¾ˆç®€å•çš„`options.data`ï¼ˆæ·±å…¥ç†è§£ä¸€ä¸‹ï¼‰ï¼Ÿ

æˆ‘ä»¬è®¤ä¸º `data` æ˜¯å¾ˆç®€å•çš„ï¼Œå³å®ƒå°±æ˜¯ä¸€ä¸ª**å†…éƒ¨æ•°æ®**è€Œå·²ï¼Œæ²¡å•¥ç‰¹åˆ«çš„

ä½†å®é™…ä¸Šï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä¹‹åå­¦ä¹  `options` çš„è¿›é˜¶å±æ€§ï¼Œæˆ‘ä»¬å¿…é¡»æ‰ç¢å®ƒï¼Œå‰¥å¼€å®ƒ

`data`çš„ä¸»è¦åŸç†ï¼Œå¯ä»¥çœ‹è¿™ä¸ªï¼š[æ·±å…¥å“åº”å¼åŸç† â€” Vue.js](https://cn.vuejs.org/v2/guide/reactivity.html) -> å†…å®¹ç¯‡å¹…å¤ªå°‘äº†ï¼Œå¯èƒ½ä½ çœ‹å®Œä¹‹åå¹¶ä¸èƒ½æ·±åˆ»çš„ç†è§£ï¼ -> å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹æºä»£ç ï¼Œä½†è¿™æ˜¯éå¸¸ä¸åˆ‡å®é™…çš„â€¦â€¦

ç›¸è¾ƒäºå®˜æ–¹æ–‡æ¡£ï¼Œæ–¹æ–¹çš„è®²è§£ -> å¯¹ `data` æ‰©å……äº†éå¸¸å¤šçš„å†…å®¹ï¼

2ï¼‰å°å®éªŒ

1ã€ä»ä¸€ä¸ªå°ç‚¹å¼€å§‹

![logçš„å¼‚åŒ](assets/img/2020-07-12-11-47-58.png)

ç»“æœï¼š

![result](assets/img/2020-07-12-11-58-49.png)

2ã€è§£é‡Š `log` çš„å¼‚åŒï¼Ÿ

å‰ç½®çŸ¥è¯†ï¼š[ES 6 æ–°ç‰¹æ€§åˆ—è¡¨](https://fangyinghang.com/es-6-tutorials/)ã€[getter å’Œ setter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer)

> å…³äº ES6 æ–°å‡ºæ¥çš„ APIï¼Œä½ **åªéœ€è¦çŸ¥é“å®ƒä»¬æ˜¯å¹²å•¥çš„å°±è¡Œäº†**ï¼Œä¸éœ€è¦è‡ªå·±åŠ¨æ‰‹å»ä¸€ä¸ªä¸ªäº†è§£ï¼Œä¹Ÿä¸éœ€è¦å»è®°ä½å®ƒä»¬æ˜¯æ€ä¹ˆç”¨çš„ -> å½“ä½ åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ°äº†æŸä¸ª APIï¼Œå†å»äº†è§£å®ƒçš„è¯­æ³•ã€ç”¨æ³•â€¦â€¦

CRUD è¿™ä¸ªå¯¹è±¡ï¼š

``` js
let obj0 = {
  å§“: "é«˜",
  å: "åœ†åœ†",
  age: 18
};
```

**â‘ éœ€æ±‚ä¸€ï¼šå¾—åˆ°å§“å**

``` js
let obj1 = {
  å§“: "é«˜",
  å: "åœ†åœ†",
  å§“å() {
    return this.å§“ + this.å;
  },
  age: 18
};

console.log("éœ€æ±‚ä¸€ï¼š" + obj1.å§“å());
// å§“ååé¢çš„æ‹¬å·èƒ½åˆ æ‰å—ï¼Ÿä¸èƒ½ï¼Œå› ä¸ºå®ƒæ˜¯å‡½æ•°
// æ€ä¹ˆå»æ‰æ‹¬å·ï¼Ÿ
```

![æ‹¬å·ä¸èƒ½åˆ ](assets/img/2020-07-12-13-10-19.png)

**â‘¡éœ€æ±‚äºŒï¼šå§“åä¸è¦æ‹¬å·ä¹Ÿèƒ½å¾—å‡ºå€¼**

``` js
let obj2 = {
  å§“: "é«˜",
  å: "åœ†åœ†",
  get å§“å() {
    return this.å§“ + this.å;
  },
  age: 18
};

console.log("éœ€æ±‚äºŒï¼š" + obj2.å§“å);

// æ€»ç»“ï¼šgetter å°±æ˜¯è¿™æ ·ç”¨çš„ã€‚ä¸åŠ æ‹¬å·çš„å‡½æ•°ï¼Œä»…æ­¤è€Œå·²ã€‚
```

![åˆ æ‰æ‹¬å·](assets/img/2020-07-12-13-12-02.png)

> ç”¨äº†ES6çš„æ–°è¯­æ³•ï¼Œä»…ä»…åœ¨`å§“å`å±æ€§åå‰è¾¹åŠ ä¸ª`get`å…³é”®å­—å°±å¯ä»¥å®ç°æˆ‘ä»¬çš„éœ€æ±‚â€¦â€¦ -> ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·ï¼Ÿ -> å—¯ï¼Œæ²¡æœ‰ä¸ºä»€ä¹ˆï¼ŒES6çš„æ–°è¯­æ³•ç‰¹æ€§å°±æ˜¯å¦‚æ­¤â€¦â€¦æ€»ä¹‹ï¼Œä½ å¯ä»¥è¿™æ ·ç†è§£ï¼š`å§“å`æœ¬è´¨æ˜¯å±æ€§ä¸æ˜¯å‡½æ•°ï¼Œä½†æ˜¯`å§“å`çš„å®šä¹‰æ˜¯ç”¨å‡½æ•°å§¿åŠ¿å®šä¹‰çš„ï¼ -> è¿™æ ·çš„`å§“å`å±æ€§å«ã€Œ**è®¡ç®—å±æ€§**ã€ï¼Œè™½ç„¶è·Ÿ**æ™®é€šå±æ€§**é•¿å¾—ä¸€æ¨¡ä¸€æ ·â€¦â€¦ -> è¯»æ³•ã€Œget ä¸€ä¸ªå±æ€§ çš„å€¼ã€ï¼Œå¦‚ã€Œget å§“å çš„å€¼ã€

**â‘¢éœ€æ±‚ä¸‰ï¼šå§“åå¯ä»¥è¢«å†™**

``` js
let obj3 = {
  å§“: "é«˜",
  å: "åœ†åœ†",
  get å§“å() {
    return this.å§“ + this.å;
  },
  set å§“å(xxx) {
    this.å§“ = xxx[0]
    this.å = xxx.substring(1)
  },
  age: 18
};

obj3.å§“å = 'é«˜åª›åª›'

console.log(`éœ€æ±‚ä¸‰ï¼šå§“ ${obj3.å§“}ï¼Œå ${obj3.å}`)

// æ€»ç»“ï¼šsetter å°±æ˜¯è¿™æ ·ç”¨çš„ã€‚ç”¨ = xxx è§¦å‘ set å‡½æ•°
```

![setter](assets/img/2020-07-12-13-31-39.png)

---

è™½ç„¶äº†è§£äº† `get` å’Œ `set` åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œæœ‰å•¥ç”¨ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸ç†è§£ `{n: (...)}` æ˜¯ä¸ªå•¥å­ä¸œè¥¿â€¦â€¦

![è››ä¸é©¬è¿¹](assets/img/2020-07-12-13-39-13.png)

å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¹¶æ²¡æœ‰å†™ä¸€ä¸ªå«ã€Œ`å§“å`ã€çš„å±æ€§ï¼ˆ**åƒä¸ªçœŸå®å±æ€§ä¸€æ ·**ï¼Œå¯¹æ¯” `get å§“å` ï¼Œé¢œè‰²æ›´ä¸ºæ˜æ˜¾ï¼ŒåŒæˆ‘ä»¬å®šä¹‰çš„æ™®é€šå±æ€§`å§“`ã€`å`ã€`age`ç®€ç›´ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯å€¼æ˜¯`(...)`ï¼‰ï¼Œä½†æ˜¯ `obj3` æ——ä¸‹å°±æ˜¯æœ‰ä¸ªå« `å§“å` çš„æ™®é€šå±æ€§ï¼

æµè§ˆå™¨çš„çœ‹æ³•ï¼š

> å¼€å‘è€…ä½ ç¡®å®å¯ä»¥å¯¹`å§“å`è¯»å’Œå†™ï¼Œä½†æ˜¯å¹¶ä¸å­˜åœ¨ä¸€ä¸ªå«`å§“å`çš„å±æ€§ -> è¯»å’Œå†™çš„æ“ä½œæ˜¯é€šè¿‡`get`å’Œ`set`å®Œæˆçš„ï¼

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼š

- `n:(...)`çš„æ„æ€æ˜¯ï¼Œå¹¶ä¸å­˜åœ¨ä¸€ä¸ªå«`n`çš„å±æ€§ï¼Œè€Œæ˜¯æœ‰ä¸ª `get n` å’Œ `set n`ï¼Œè¿™ä¿©ä¸œè¥¿ç”¨æ¥æ¨¡æ‹Ÿå¯¹ `n` çš„è¯»å†™æ“ä½œï¼

**è™½ç„¶æˆ‘ä»¬ç†è§£äº†`n:(...)`è¿™ç§å½¢å¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸ç†è§£ä¸ºå•¥è¦æŠŠ`n`å˜æˆæ˜¯`get n`å’Œ`set n`**

---

Qï¼šå¯¹è±¡çš„æ–¹æ³•å®šä¹‰æœ‰å‡ ç§å§¿åŠ¿ï¼Ÿ

æœ€å¸¸è§çš„å§¿åŠ¿ï¼ˆå¼•å…¥å‡½æ•°ï¼‰ï¼š

``` js
let o = {
  property: function (parameters) {},
}  
```

ç®€å†™å§¿åŠ¿ï¼ˆä¸éœ€è¦ç”¨å…³é”®å­—`function`æç¤ºè¿™æ˜¯ä¸€ä¸ªå¼•å…¥äº†å‡½æ•°çš„å±æ€§ï¼‰ï¼š

``` js
// Shorthand method names (ES2015)
let o = {
  property(parameters) {},
}
```

ä¸å¸¸è§ä½†å¾ˆæœ‰ç”¨çš„å§¿åŠ¿ï¼ˆå¼•å…¥`getter` or `setter`æ–¹æ³•ï¼‰ï¼š

``` js
let o = {
  get property() {},
  set property(value) {}
}
```

æˆ‘çš„è®¤çŸ¥æ”¹å˜ï¼š

- æœ‰`function`çš„å±æ€§
- æœ‰`getter`çš„å±æ€§
- æœ‰`setter`çš„å±æ€§

ã€Œ`function`æ–¹æ³•ã€ & ã€Œ`getter`æ–¹æ³• or `setter`æ–¹æ³•ã€ æ˜¯æœ‰åŒºåˆ«çš„ï¼

Qï¼šè§¦å‘ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œæœ‰ä¸‰ç§å§¿åŠ¿ï¼Ÿ

- `xxx.name()`
- `xxx.name`
- `xxx.fullName = 'æ¯›ä¸æ˜“'`

## â˜…`Object.defineProperty`

åœ¨ä¸Šä¸ªæ ‡é¢˜é‡Œè¾¹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼š

> ES6æä¾›äº†ä¸€ç§æ–°çš„è¯­æ³•ç‰¹æ€§ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šè®¾ç½®ä¸€ä¸ª`getter`å’Œä¸€ä¸ª`setter`ï¼Œç„¶åå¯¹ä¸€ä¸ªè™šæ‹Ÿçš„å±æ€§è¿›è¡Œè¯»å†™â€¦â€¦

æ–‡æ¡£ï¼š[Object.defineProperty()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty) -> ä¸»è¦çœ‹ Examples

1ï¼‰å¦‚ä½•ä½¿ç”¨`Object.defineProperty()`ï¼Ÿ

æˆ‘ä»¬ä¹‹å‰åœ¨å£°æ˜å¹¶åˆå§‹åŒ–`obj3`çš„æ—¶å€™å°±ç›´æ¥å†™äº†å®ƒçš„`get`å’Œ`set`ï¼š

``` js
let obj3 = {
  å§“: "é«˜",
  å: "åœ†åœ†",
  get å§“å() {
    return this.å§“ + this.å;
  },
  set å§“å(xxx) {
    this.å§“ = xxx[0]
    this.å = xxx.substring(1)
  },
  age: 18
};
```

ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¹‹åè¿˜æœ‰ä¸º`obj3`æ·»åŠ æ–°çš„`get`å’Œ`set`å±æ€§å‘¢ï¼Ÿå¦‚è¿™æ ·ï¼š`obj3.get xxx() {}`ï¼Œæ˜¾ç„¶è¿™æ˜¯åŠ ä¸äº†çš„â€¦â€¦

æ‰€ä»¥è¿™ä¸ªæ—¶å€™ `Object.defineProperty()` å°±æ´¾ä¸Šç”¨åœºäº†â€¦â€¦

å®ƒçš„å‚æ•°ï¼š

1. ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå‘Šè¯‰æˆ‘ä½ è¦åœ¨å“ªä¸ªå¯¹è±¡ä¸Šè¿›è¡Œ`define`ï¼Œå³ä½ è¦`define`å“ªä¸ªå¯¹è±¡
2. ç¬¬äºŒä¸ªå‚æ•°ï¼šå‘Šè¯‰æˆ‘ä½ è¦å®šä¹‰ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œå¦‚ä¸€ä¸ªå« `xxx` çš„ä¸œè¥¿ï¼ˆ**è™šæ‹Ÿå±æ€§**ï¼‰
3. ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå¯¹è±¡å€¼ï¼Œå†™ä¸Š`get`å’Œ`set`å°±å¥½äº†ï¼Œæ³¨æ„ä½ ä¸éœ€è¦è¿™æ ·å†™ `get xxx(){}`â€¦â€¦å› ä¸ºç¬¬äºŒä¸ªå‚æ•°å·²ç»æ˜ç¡®äº†è¿™æ˜¯ä¸€ä¸ªå«`xxx`çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä½ ç›´æ¥ `get(){}` å°±è¡Œäº† -> ä¸è¦å¤šæ­¤ä¸€ä¸¾å“ˆï¼ï¼ˆï¼‰

![ä½¿ç”¨](assets/img/2020-07-12-20-20-23.png)

> é€šè¿‡`Object.defineProperty()`è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ç»™`obj3`æ·»åŠ äº†ä¸€ä¸ªè™šæ‹Ÿå±æ€§`xxx`ï¼Œä¹Ÿå«å±æ€§â€¦â€¦åœ¨å®šä¹‰`xxx`çš„`set`æ–¹æ³•æ—¶ï¼Œ`xxx`è¿™ä¸ªå±æ€§æ˜¯ä¸å­˜åœ¨çš„ï¼Œå³ `obj3` æ­¤æ—¶æ˜¯å’©æœ‰è¿™ä¸ªå±æ€§çš„ï¼Œå³ä¾¿æˆ‘ä»¬åœ¨å¤–ç•Œå¯ä»¥`obj3.xxx`è¿™æ ·è®¿é—®ï¼Œä½†è¿™æ ·è®¿é—®çš„æœ¬è´¨æ˜¯è°ƒç”¨äº†`getter`å’Œ`setter`æ–¹æ³•ï¼Œä¹‹å‰æˆ‘ä»¬åˆå§‹åŒ–`obj3`ä¹‹æ‰€ä»¥å¯ä»¥ç”¨`this.å§“`å•¥çš„ï¼Œé‚£æ˜¯å› ä¸º`obj3`å°±æ˜¯æœ‰ä¸ª`å§“`å±æ€§å‘€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»å¾—æ‰¾ä¸€ä¸ªä¸œè¥¿æ¥æ”¾ç½®`set`è¿‡æ¥çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«`_xxx`çš„ä¸œè¥¿ï¼Œç”¨æ¥å­˜å‚¨`xxx`çš„å€¼ï¼Œè€Œæ¯æ¬¡`get`çš„å€¼ï¼Œå®é™…æ‹¿åˆ°çš„æ˜¯`_xxx`çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´`get`å’Œ`set`ä¸`_xxx`æ„æˆäº†é—­åŒ…â€¦â€¦

æ³¨æ„ï¼Œ`set`å’Œ`get`é‡Œè¾¹çš„`this`æŒ‡å‘æ˜¯`obj3`å“ˆï¼

æ€»ä¹‹ï¼Œå®šä¹‰å®Œä¸€ä¸ª`obj3`ä¹‹åï¼Œä½ è¿˜æƒ³è¿½åŠ æ‰€è°“çš„ã€Œè™šæ‹Ÿå±æ€§ã€çš„è¯ï¼Œé‚£ä¹ˆä½ å¾—é€šè¿‡`Object.defineProperty()`æ¥å“ˆï¼è€Œä¸”å…³äºè¿™**æ–°çš„**è™šæ‹Ÿå±æ€§ï¼ˆå‡å¦‚å«`xxx`ï¼‰ï¼Œä½ åœ¨`Object.defineProperty()`çš„ç¬¬ä¸‰ä¸ªå‚æ•°é‡Œè¾¹çš„`set`å’Œ`get`æ˜¯ä¸èƒ½å‡ºç°`this.xxx`è¿™æ ·çš„ä»£ç ï¼Œå¦‚æœå‡ºç°äº†ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æ­»å¾ªç¯ï¼Œç„¶åçˆ†æ ˆï¼ -> é¿å…æ­»å¾ªç¯ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼ˆå…¨å±€ä¹Ÿå¥½ï¼Œå±€éƒ¨ä¹Ÿç½¢ï¼Œå¦‚å«`_xxx`ï¼‰ï¼Œç”¨æ¥å­˜å‚¨`xxx`è¿™ä¸ªå±æ€§çš„å€¼ï¼Œ`get xxx`ï¼Œå³`obj3.xxx`æ—¶æ‹¿åˆ°çš„æ˜¯`_xxx`çš„å€¼ï¼Œ`set xxx`ï¼Œå³`obj3.xxx = 'hi'`æ—¶ï¼Œ`update`çš„ä¸œè¥¿æ˜¯`_xxx`â€¦â€¦ -> `xxx`ç»™æˆ‘çš„æ„Ÿè§‰å°±åƒæ˜¯ä¸ªå‚€å„¡ä¸€æ ·ï¼è¡¨é¢ä¸Šçœ‹`xxx`çœŸå¾—æ˜¯`obj3`çš„å±æ€§ï¼Œå®é™…ä¸Šæ˜¯ä¸ªè¢«`setter`å’Œ`getter`æ“æ§çš„å‚€å„¡ï¼

---

ç›®å‰ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†`getter`ã€`setter`ä»¥åŠ`Object.defineProperty()`ï¼Œä½†æˆ‘ä»¬ä¾æ—§è¿˜æ˜¯ä¸ç†è§£ä¸ºå•¥ä¼šæœ‰`{n:0} -> vm -> {n:(...)}`è¿™æ ·çš„å˜åŒ–ï¼

> `getter`å’Œ`setter`ï¼šåœ¨å®šä¹‰ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥å®šä¹‰ä¸€ä¸ª`getter`å’Œ`setter`
> 
> `Object.defineProperty()`ï¼šå®šä¹‰å®Œå¯¹è±¡è¿‡ä¹‹åï¼Œä½ åˆçªç„¶æƒ³åŠ ä¸€ä¸ª`getter`å’Œ`setter`ï¼Œé‚£å°±ä½¿ç”¨`Object.defineProperty()`è¿™ä¸ªä¸œè¥¿æ¥æå§ï¼

## â˜…ä»£ç†å’Œç›‘å¬

æµ‹è¯•å¯¹è±¡ï¼š

``` js
let data0 = {
  n: 0
}
```

1ï¼‰éœ€æ±‚ä¸€ï¼šç”¨ `Object.defineProperty` å®šä¹‰ `n`

``` js
let data1 = {}

Object.defineProperty(data1, 'n', {
  value: 0
})

console.log(`éœ€æ±‚ä¸€ï¼š${data1.n}`)

// æ€»ç»“ï¼šè¿™ç…ç¬”è¯­æ³•æŠŠäº‹æƒ…æå¤æ‚äº†ï¼Ÿéä¹Ÿï¼Œç»§ç»­çœ‹ã€‚
```

åˆ†æï¼š

![éœ€æ±‚ä¸€](assets/img/2020-07-13-14-30-15.png)

ä¸€ä¸ªæ— å˜å¤´çš„çœ‹æ³•ï¼ˆå¤©ç”Ÿçš„å±æ€§ vs åæ¥çš„å±æ€§ï¼‰ï¼š

![é¢œè‰²æ·±æµ…](assets/img/2020-07-13-14-34-17.png)

> é€šè¿‡ `Object.defineProperty` å®šä¹‰çš„å±æ€§ä¼¼ä¹åœ¨å‘Šè¯‰æˆ‘ï¼Œæ­¤å±æ€§æœ€å¥½ä¸è¦è®¿é—®ï¼Œå°±è·Ÿ IE ç¦æ­¢ä½¿ç”¨ `__proto__` ä¸€æ ·

2ï¼‰éœ€æ±‚äºŒï¼š`n` ä¸èƒ½å°äº `0`

> å³ `data2.n = -1` åº”è¯¥æ— æ•ˆï¼Œä½† `data2.n = 1` æœ‰æ•ˆ

``` js
let data2 = {}

data2._n = 0 // _n ç”¨æ¥å·å·å­˜å‚¨ n çš„å€¼

Object.defineProperty(data2, 'n', {
  get() {
    return this._n
  },
  set(value) {
    if (value < 0) return
    this._n = value
  }
})

console.log(`éœ€æ±‚äºŒï¼š${data2.n}`)
data2.n = -1
console.log(`éœ€æ±‚äºŒï¼š${data2.n} è®¾ç½®ä¸º -1 å¤±è´¥`)
data2.n = 1
console.log(`éœ€æ±‚äºŒï¼š${data2.n} è®¾ç½®ä¸º 1 æˆåŠŸ`)

// æŠ¬æ ï¼šé‚£å¦‚æœå¯¹æ–¹ç›´æ¥ä½¿ç”¨ data2._n å‘¢ï¼Ÿ
// ç®—ä½ ç‹ 
```

è§£æï¼š

ä¸ºå•¥ä¸èƒ½ `data2.n = -1` è¿™æ ·ï¼Ÿè¿™ç§èµ‹å€¼æ“ä½œä¸æ˜¯çƒ‚å¤§è¡—äº†å—ï¼Ÿè¿˜æœ‰ä»€ä¹ˆå€¼æ˜¯ä¸èƒ½èµ‹ç»™å˜é‡çš„ï¼ŸJS å¯ä¸æ˜¯å¼ºç±»å‹è¯­è¨€å‘€ï¼

> é€šè¿‡ES6çš„`getter`å’Œ`setter`æ˜¯å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹çš„ï¼

åšæ³•è¦ç‚¹ï¼š

- éœ€è¦ä¸€ä¸ªçœŸå®çš„`_n`ï¼ˆå‘½åéšæ„ï¼Œä½†ä¸€èˆ¬æœ‰ä¸‹åˆ’çº¿`_`å¼€å¤´çš„å±æ€§ï¼Œéƒ½æ˜¯å‘Šè¯‰APIè°ƒç”¨ä»”ä¸è¦è®¿é—®è¿™ä¸ª`_n` -> å®ƒæ˜¯å½¢å¼ä¸Šç§æœ‰çš„ï¼ŒAPIè°ƒç”¨ä»”è®¿é—®å®ƒä¼šå¾ˆå±é™©ï¼‰ï¼Œç”¨æ¥å­˜å‚¨è™šæ‹Ÿçš„`n`
- ä¸ºå•¥ `get` å’Œ `set`é‡Œè¾¹ç”¨çš„æ˜¯`this`ï¼Œè€Œä¸æ˜¯`data2`ï¼Ÿ -> å› ä¸ºä¸‡ä¸€ä¸å«`data2`äº†å‘¢ï¼Ÿè€Œ`this`å°±æ˜¯`data2`ï¼Œå°±æ˜¯å½“å‰çš„è¿™ä¸ª`data2`å¯¹è±¡ï¼Œä½ æ¢æˆæ˜¯`data666`ï¼Œé‚£ä¹ˆ`this`å°±æ˜¯`data666`
- ä¸€ä¸ªå­˜å‚¨å±æ€§å€¼çš„åœ°æ–¹ï¼Œä¸€ä¸ªè¯»å±æ€§çš„åœ°æ–¹ï¼Œä¸€ä¸ªå†™å±æ€§çš„åœ°æ–¹

![å›¾ç¤ºä¸‰ä¸ªåœ°æ–¹](assets/img/2020-07-13-14-53-54.png)

å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†`get`å’Œ`set`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨`set`é‡Œè¾¹åšä¸ªåˆ¤æ–­ï¼Œå³ä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±ä¸`set`ï¼Œç”šè‡³å¯ä»¥æŠ¥ä¸€ä¸ªé”™ï¼

é—®é¢˜æ¥äº†ï¼š

1. APIè°ƒç”¨ä»”ï¼Œå±…ç„¶è¿™æ ·åšï¼š`obj2._n = -1` -> è¿™æ ·ä¸€æ¥ï¼Œ`n`å°±æ˜¯`-1`çš„åˆå§‹å€¼äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„éœ€æ±‚GGäº†ï¼

æ€ä¹ˆåŠï¼Ÿ

1. `data2`å¯¹è±¡çš„è¿™ä¸ª`_n`å±æ€§ï¼Œèƒ½ä¸èƒ½ä¸è¦æš´éœ²ç»™ API è°ƒç”¨ä»”ï¼Ÿç”šè‡³èƒ½å¦è¿`data2`è¿™ä¸ªåå­—ä¹Ÿä¸è¦æš´éœ²ç»™ API è°ƒç”¨ä»”ï¼Ÿ

æ–¹æ¡ˆï¼š

> ä½¿ç”¨ä»£ç†ï¼

3ï¼‰éœ€æ±‚ä¸‰ï¼šä½¿ç”¨ä»£ç†

``` js
let data3 = proxy({ data: { n: 0 } }) // æ‹¬å·é‡Œæ˜¯åŒ¿åå¯¹è±¡ï¼Œæ— æ³•è®¿é—®

function proxy({ data }/* è§£æ„èµ‹å€¼ï¼Œåˆ«TMè€é—® */) {
  const obj = {}
  // è¿™é‡Œçš„ 'n' å†™æ­»äº†ï¼Œç†è®ºä¸Šåº”è¯¥éå† data çš„æ‰€æœ‰ keyï¼Œè¿™é‡Œåšäº†ç®€åŒ–
  // å› ä¸ºæˆ‘æ€•ä½ ä»¬çœ‹ä¸æ‡‚
  Object.defineProperty(obj, 'n', {
    get() {
      return data.n
    },
    set(value) {
      if (value < 0) return
      data.n = value
    }
  })
  return obj // obj å°±æ˜¯ä»£ç†
}

// data3 å°±æ˜¯ obj
console.log(`éœ€æ±‚ä¸‰ï¼š${data3.n}`)
data3.n = -1
console.log(`éœ€æ±‚ä¸‰ï¼š${data3.n}ï¼Œè®¾ç½®ä¸º -1 å¤±è´¥`)
data3.n = 1
console.log(`éœ€æ±‚ä¸‰ï¼š${data3.n}ï¼Œè®¾ç½®ä¸º 1 æˆåŠŸ`)

// æ ç²¾ä½ è¿˜æœ‰è¯è¯´å—ï¼Ÿ
// æ ç²¾è¯´æœ‰ï¼ä½ çœ‹ä¸‹é¢ä»£ç 
```

è§£æè¦ç‚¹ï¼š

![æ— äººå¯ä¿®æ”¹](assets/img/2020-07-13-15-17-10.png)

å¯ä»¥çœ‹åˆ°ï¼ŒAPI è°ƒç”¨ä»”æ˜¯æ— æ³•å»ä¿®æ”¹æˆ‘å†™çš„ä»£ç çš„ï¼

`{ data: { n: 0 } }` -> å°±æ˜¯`options` -> é€šè¿‡è§£æèµ‹å€¼æ‹¿åˆ°ã€ŒçœŸå®çš„å€¼ã€`{ n: 0 }`

ä¸€ä¸ªæ¯”å–»ï¼ˆä»£ç†æœ‰æˆ¿å­å—ï¼Ÿ vs æˆ¿å­æ˜¯æˆ¿ä¸œçš„ï¼‰ï¼š

![æ¯”å–»](assets/img/2020-07-13-15-31-34.png)

ä½ æ˜¯ç§Ÿæˆ¿çš„ï¼Œä¸­ä»‹æ˜¯`obj`ï¼Œæˆ¿ä¸œæ˜¯`data`

![ä»£ç†çš„ä½œç”¨](assets/img/2020-07-13-15-39-01.png)

å½“æˆ‘ä»¬`data3.n`çš„æ—¶å€™ï¼Œè®¿é—®çš„æ˜¯`obj`çš„è™šæ‹Ÿå±æ€§`n`ï¼Œä½†æ‹¿åˆ°çš„æ˜¯`data.n`çš„å€¼ -> é—¨é¢ä¸Šä½ ç§Ÿçš„æˆ¿å­åƒæ˜¯ä¸­ä»‹æ‰€å±çš„ï¼Œå®é™…ä¸Šæ˜¯æˆ¿ä¸œçš„ï¼

æ‰€ä»¥ï¼Œæ€»ä½“ä¸Šçœ‹ï¼š

- æˆ‘ä»¬çš„ä»£ç åªæš´éœ²äº†ä»£ç†å¯¹è±¡ï¼Œå’©æœ‰æš´éœ²çœŸå®çš„`data`å¯¹è±¡ï¼ -> API è°ƒç”¨ä»”å¯¹ `data` æ——ä¸‹çš„å±æ€§çš„ä»»ä½•æ“ä½œï¼Œéƒ½è¦ç»è¿‡ã€Œä¸­ä»‹ã€çš„æŠŠå…³ï¼Œå¦‚ä½ ä¸èƒ½å…»å® ç‰©ï¼Œä½ ä¸èƒ½ä¸æˆ¿ä¸œå¯¹è¯äº¤æµï¼Œä½ ä¸èƒ½ä»äº‹è¿æ³•èŒä¸šç­‰ç­‰â€¦â€¦

æ€»ä¹‹ï¼ŒAPI è°ƒç”¨ä»” æ— æ³•ç›´æ¥ä¿®æ”¹ `data`ï¼Œå¿…é¡»å¾—ç»è¿‡ä»£ç†çš„å®¡æŸ¥ï¼Œç¡®è®¤æ— è¯¯åï¼Œæ‰èƒ½ä¿®æ”¹`data`

ä¸è¿‡ï¼Œè¿™æ ·ä¾æ—§å­˜åœ¨é—®é¢˜ï¼š

![ä¾æ—§æœ‰bug](assets/img/2020-07-13-15-57-54.png)

APIè°ƒç”¨ä»”ç»•è¿‡äº†ä»£ç†ï¼Œç›´æ¥æ“ä½œçœŸå®æ•°æ®ï¼

4ï¼‰éœ€æ±‚å››

``` js
let myData = { n: 0 }
let data4 = proxy({ data: myData }) // æ‹¬å·é‡Œæ˜¯åŒ¿åå¯¹è±¡ï¼Œæ— æ³•è®¿é—®

// data3 å°±æ˜¯ obj
console.log(`æ ç²¾ï¼š${data4.n}`)
myData.n = -1
console.log(`æ ç²¾ï¼š${data4.n}ï¼Œè®¾ç½®ä¸º -1 å¤±è´¥äº†å—ï¼ï¼Ÿ`)

// æˆ‘ç°åœ¨æ”¹ myDataï¼Œæ˜¯ä¸æ˜¯è¿˜èƒ½æ”¹ï¼Ÿï¼ä½ å¥ˆæˆ‘ä½•
// è‰¹ï¼Œç®—ä½ ç‹ 
```

5ï¼‰éœ€æ±‚äº”ï¼šå°±ç®—ç”¨æˆ·æ“…è‡ªä¿®æ”¹ `myData`ï¼Œä¹Ÿè¦æ‹¦æˆªä»–

``` js
let myData5 = { n: 0 }
let data5 = proxy2({ data: myData5 }) // æ‹¬å·é‡Œæ˜¯åŒ¿åå¯¹è±¡ï¼Œæ— æ³•è®¿é—®

function proxy2({ data }/* è§£æ„èµ‹å€¼ï¼Œåˆ«TMè€é—® */) {
  // è¿™é‡Œçš„ 'n' å†™æ­»äº†ï¼Œç†è®ºä¸Šåº”è¯¥éå† data çš„æ‰€æœ‰ keyï¼Œè¿™é‡Œåšäº†ç®€åŒ–
  // å› ä¸ºæˆ‘æ€•ä½ ä»¬çœ‹ä¸æ‡‚
  let value = data.n
  // delete data.n // -> å¯ä»¥ä¸å†™ï¼Œå› ä¸ºåé¢å®šä¹‰è™šæ‹Ÿå±æ€§çš„æ—¶å€™ï¼Œå¯ä»¥è¦†ç›–æ‰
  Object.defineProperty(data, 'n', {
    get() {
      return value
    },
    set(newValue) {
      if (newValue < 0) return
      value = newValue
    }
  })
  // å°±åŠ äº†ä¸Šé¢å‡ å¥ï¼Œè¿™å‡ å¥è¯ä¼šç›‘å¬ data

  const obj = {}
  Object.defineProperty(obj, 'n', {
    get() {
      return data.n
    },
    set(value) {
      if (value < 0) return//è¿™å¥è¯å¤šä½™äº†
      data.n = value
    }
  })

  return obj // obj å°±æ˜¯ä»£ç†
}

// data3 å°±æ˜¯ obj
console.log(`éœ€æ±‚äº”ï¼š${data5.n}`)
myData5.n = -1
console.log(`éœ€æ±‚äº”ï¼š${data5.n}ï¼Œè®¾ç½®ä¸º -1 å¤±è´¥äº†`)
myData5.n = 1
console.log(`éœ€æ±‚äº”ï¼š${data5.n}ï¼Œè®¾ç½®ä¸º 1 æˆåŠŸäº†`)
```

ç®€å•è§£æï¼š

![proxy2çš„é€»è¾‘](assets/img/2020-07-13-16-18-38.png)

å¯ä»¥çœ‹åˆ°ï¼Œä¸ç®¡ä½ æ˜¯é€šè¿‡`myData5.n`æ¥è¯»å†™ï¼Œè¿˜æ˜¯é€šè¿‡`data5.n`æ¥è¯»å†™ï¼Œéƒ½ä¼šè¢«`getter`ã€`setter`ç›‘å¬åˆ°ï¼

6ï¼‰è¿™ä»£ç çœ‹ç€çœ¼ç†Ÿå—ï¼Ÿ

``` js
let data5 = proxy2({ data:myData5 }) 
let vm = new Vue({data: myData})
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¹‹å‰ä¸æ‡‚çš„è¿™ä¸ªï¼š`{n:0} -> vm -> {n:(...)}`ï¼Œç°åœ¨è½»è€Œæ˜“ä¸¾åœ°å°±èƒ½çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆäº†ï¼

ä»¥ä¸Šè®²çš„åŸç†ï¼Œå°±æ˜¯ Vue å†…éƒ¨çš„æºä»£ç ï¼

7ï¼‰ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯´è¯´ `new Vue` åšäº†ä»€ä¹ˆäº†

``` js
vm = new Vue({data: myData})
```

è¿™è¡Œä»£ç ï¼ŒVue åšä¸¤ä»¶äº‹æƒ…ï¼š

1. è®©`vm` æˆä¸º `myData` çš„ä»£ç† -> ä½  `vm.m` å°±æ˜¯åœ¨å– `myData.m`ï¼Œä½  `vm.v` å°±æ˜¯åœ¨å– `myData.v`ï¼ŒåŒæ ·ï¼Œ`vm.v = 'hi'`è¿™æ ·èµ‹å€¼ï¼Œä¹Ÿæ˜¯åœ¨å¯¹`myData.v`èµ‹å€¼â€¦â€¦ -> é€šè¿‡`this`æ¥è®¿é—®`v`ã€`m`å±æ€§ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå› ä¸º`this`å°±æ˜¯ä»£ç†ï¼Œå°±æ˜¯`vm`
2. å¯¹`myData`çš„æ‰€æœ‰å±æ€§è¿›è¡Œç›‘æ§ -> è™½ç„¶æˆ‘ä»¬åœ¨ä½¿ç”¨ Vue çš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ `new Vue({data: {n:0}})` è¿™æ ·åšçš„ï¼Œä½†æ˜¯å¥ˆä½•æ€»æœ‰äººä¼š`new Vue({data: myData})`è¿™æ ·å†™ -> å¿…é¡»è¦è®©ä»£ç†`vm`çŸ¥é“æ‰€æœ‰çš„äº‹æƒ…ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥è°ƒç”¨`render(data)`ï¼Œç„¶åæ›´æ–° UI äº†ï¼ä¸ç„¶ï¼Œ`myData`å˜åŒ–äº†ï¼ŒUI è¿˜æ˜¯æ²¡æœ‰ä½œå‡ºç›¸åº”çš„å˜åŒ–ï¼

æ€»ä¹‹ï¼ŒVue åšäº†é‚£ä¹ˆå¤šåŠŸå¤«ï¼Œæ€»è€Œè¨€ä¹‹å°±ä¸€å¥è¯ï¼š

> ä½ å¯¹ `data` çš„ä»»ä½•ä¿®æ”¹ï¼Œæˆ‘ Vue å¿…é¡»è¦çŸ¥é“ï¼ä¸ç„¶ï¼Œæˆ‘å°±æ— æ³•å»`render`äº†ï¼ -> æ— æ³•`render`ï¼ŒUI å°±ä¸ä¼šå˜åŒ–äº†ï¼é‚£ä¹ˆ æˆ‘è¿™ä¸ª Vue çš„ç«‹èº«ä¹‹æœ¬ä¹Ÿå°±æ²¡æœ‰äº†ï¼

8ï¼‰å°ç»“

ç ”ç©¶æ–¹æ³•ï¼š

æ–¹æ–¹å¯¹`data`çš„**ç ”ç©¶æ–¹æ³•**è¦æ¯”çŸ¥è¯†æœ¬èº«æ›´ä¸ºé‡è¦ï¼Œé‚£è¿™æ˜¯ä»€ä¹ˆç ”ç©¶æ–¹æ³•å‘¢ï¼Ÿ

![æ‰“log](assets/img/2020-07-13-16-46-51.png)

é€šè¿‡è¿™ä¸¤ä¸ª`log`ï¼Œæˆ‘ä»¬å‘ç°äº†`myData`è¢« `Vue` å¤„ç†ä¹‹å‰ï¼Œå’Œè¢«`Vue`å¤„ç†ä¹‹åï¼Œçš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼

æ˜¾ç„¶ï¼Œé€šè¿‡æ–¹æ–¹çš„è®²è§£ä¹‹åï¼Œæˆ‘ä»¬çŸ¥é“äº†ä¸€æ—¦ä¼ å…¥äº†`myData`ç»™ Vueï¼Œé‚£ä¹ˆ Vue å°±ä¼šå¯¹è¿™ä¸ª `myData` è¿›è¡Œä¸²æ”¹ï¼Œè€Œè¿™æ ·çš„ç»“æœæ˜¯ï¼Œä¹‹å‰çš„`n`ä¸è§äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯`get n() {}` å’Œ `set n() {}`

æ€»ä¹‹ï¼Œä½ å¾—å­¦ä¼šè¿™ç§æ‰“`log`å§¿åŠ¿ï¼Œå°±æ˜¯å¤„ç†å‰è¿™ä¸œè¥¿æ˜¯å’‹æ ·çš„ï¼Ÿå¤„ç†åè¿™ä¸œè¥¿æ˜¯å’‹æ ·çš„ï¼Ÿ -> æ€è€ƒã€Œä¸ºå•¥ä¼šæœ‰è¿™æ ·çš„å˜åŒ–ï¼ŸVue åˆ°åº•å¯¹ `myData` åšäº†ä»€ä¹ˆï¼Ÿã€

> æˆ‘ä»¬åœ¨ä½¿ç”¨å…¶å®ƒç±»åº“çš„æ—¶å€™ï¼Œæ ¹æœ¬å°±ä¸ä¼šè¿™æ ·ä¼ å‚æ•°ï¼š`{data:myData}`ï¼Œå³ä¸ä¼šç”¨ä¸ªå˜é‡æ¥ä¼ ï¼è€Œæ˜¯ç›´æ¥ç»™ä¸ªåŒ¿åçš„æ•°æ®ï¼Œå¦‚`{data:{n:0}}` -> ä¸ç„¶ï¼Œä½ æ°¸è¿œéƒ½æƒ³ä¸åˆ° `{n:0}` æ˜¯å¦å·²ç»æœ‰äº†å˜åŒ–

è¿™äº›ç ”ç©¶æ–¹æ³•çš„æ„ä¹‰ï¼š

- é€šè¿‡è¿™äº›ç ”ç©¶æ–¹æ³•ä½ èƒ½å¾—åˆ°ä¸€ä¸ªæœ¬é¢†ï¼šé‚£å°±æ˜¯ä½ **ä¸è¯»æºç **ï¼Œä¹Ÿèƒ½äº†è§£çœŸç›¸ï¼ -> ä¸ºä»€ä¹ˆï¼Ÿ -> å› ä¸ºä½ èƒ½å¤Ÿå› æ­¤å‘ç°ã€Œè››ä¸é©¬è¿¹ã€ï¼Œä»»ä½•ä¸€äº›å°çš„åŒºåˆ«ä½ éƒ½èƒ½é€šè¿‡ `log` æ‰“å‡ºæ¥ï¼Œç„¶åä½ å°±å»æ¢è®¨ã€Œä¸ºä»€ä¹ˆã€ï¼Œè¿™æ ·ä¸€æ¥ï¼Œè¿˜éœ€è¦çœ‹æºä»£ç å—ï¼Ÿ

è¯è¯´ï¼Œæ–¹æ–¹æ˜¯å¦‚ä½•æŸ¥çœ‹æºä»£ç ï¼Œç„¶åæ¥éªŒè¯è‡ªå·±æ˜¯å¯¹çš„å‘¢ï¼Ÿ -> æ–¹æ–¹è¯´çœ‹æºç æ˜¯å¾ˆéš¾çš„ï¼Œå…¶éš¾åº¦æ¯”ä¸Šè¿°æ¢ç©¶ã€Œä¸ºä»€ä¹ˆã€çš„è¿‡ç¨‹ï¼Œè¿˜è¦**éš¾ 100 å€ä»¥ä¸Š**ï¼

![ä»£ç†å’Œç›‘å¬](assets/img/2020-07-13-17-04-31.png)

## â˜…ç°åœºé£™è½¦çœ‹ Vue.js æºä»£ç 

- **çŸ¥é“åŸç†åæ‰å»çœ‹æºç **ï¼Œè€Œä¸æ˜¯çœ‹äº†æºç æ‰çŸ¥é“åŸç† -> ä¸çŸ¥é“åŸç†å»çœ‹æºç ï¼Œæ˜¯å®Œå…¨çœ‹ä¸æ‡‚æºç çš„ï¼
- é€šè¿‡æºç å­¦ä¹ æ˜¯é«˜æ‰‹éª—ä½ çš„ï¼Œåƒæ–¹æ–¹è¿™æ ·æ°´å¹³çš„äººï¼Œçœ‹æºç æ˜¯å¾ˆè‡ªç„¶çš„ï¼Œå³èƒ½å¤Ÿå¿«é€ŸçŸ¥é“è¿™è¡Œæºç æœ‰é—®é¢˜ï¼Œé‚£è¡Œæºç æœ‰é—®é¢˜ -> å¯¹äºé«˜æ‰‹è€Œè¨€ï¼Œçœ‹æºç æ˜¯å¥½çš„å­¦ä¹ æ–¹å¼ï¼Œ**å› ä¸ºå®ƒä»¬åˆ†åˆ†é’Ÿå°±èƒ½çœ‹å‡ºå…¶ä¸­çš„åŸç†ï¼Œä¸éœ€è¦è‡ªå·±èŠ±æ—¶é—´å»ççŒœï¼**ä½†æ–¹æ–¹ä¹‹æ‰€ä»¥èƒ½çœ‹æ‡‚ï¼Œæ˜¯å› ä¸ºä»–å·²ç»å†™å¥½å‡ å¹´çš„JSäº†ï¼Œç”¨äº†å¥½å‡ å¹´çš„ Vue äº†ï¼Œæ‰€ä»¥å¯¹äºé«˜æ‰‹æ¥è¯´ï¼Œçœ‹æºç å­¦ä¹ æ˜¯å¾ˆå¥½çš„ï¼ä½†**å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œçœ‹æºç å°±æ˜¯è‡ªæ€**ï¼å°±åƒæ˜¯å¯¹äºæ–°æ‰‹è€Œè¨€ï¼Œæºç å°±æ˜¯è¿·å®«ï¼Œæ–°æ‰‹å¾ˆå¿«å°±ä¼šè¿·å¤±æ‰ï¼Œæ–°æ‰‹è¿˜æ²¡èµ°åˆ°è‡ªå·±æƒ³è¦çš„ä½ç½®ï¼Œå°±å·²ç»åœ¨è·¯é€”ä¸­æ­»æ‰äº†ï¼Œè€Œè€æ‰‹ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€æ¡ç¡®åˆ‡çš„è·¯çº¿ï¼Œä¸€å…³ä¸€å…³åœ°èµ°ä¸‹å»ï¼
- åœ¨ä½ ä½¿ç”¨ Vue ä¸è¶…è¿‡ä¸€å¹´çš„æƒ…å†µä¸‹ï¼Œä¸è¦çœ‹ Vue çš„æºç ï¼›åœ¨ä½ ä½¿ç”¨ Vue è¶…è¿‡ä¸€å¹´çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸è¦çœ‹ Vue æºç ï¼Œä¸ºå•¥è¿™æ ·è¯´å‘¢ï¼Ÿå› ä¸ºæ—¢ç„¶ä½ å·²ç»è¿™ä¹ˆç†Ÿæ‚‰ Vue äº†ï¼Œä½ è‡ªç„¶å¯ä»¥çŒœåˆ°å®ƒæ˜¯æ€ä¹ˆå®ç°çš„äº†ï¼å°±åƒæ˜¯æ–¹æ–¹è¿™æ ·èƒ½çŒœåˆ°å®ƒæ˜¯å¦‚ä½•å®ç°ä¸€æ · -> æ€»ä¹‹ï¼Œ**ä¸ç®¡ä½ ç†Ÿæ‚‰ Vue ä¹Ÿå¥½ï¼Œä¸ç†Ÿæ‚‰ Vue ä¹Ÿç½¢ï¼Œéƒ½å’©æœ‰å¿…è¦çœ‹æºç **ï¼Œè€Œæ˜¯ä½ åº”è¯¥å»**æŠŠ ES6 çš„ `getter` å’Œ `setter`ã€`Object.defineProperty()`ç­‰è¿™äº›ä¸œè¥¿ææ¸…æ¥š**ï¼Œè€Œææ¸…æ¥šè¿™äº›ä¸œè¥¿ï¼Œå°± ok äº†ï¼

## â˜…å°ç»“






















































