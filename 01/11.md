| âœï¸ Tangxt | â³ 2020-07-25 | ğŸ·ï¸ vue-router |

# 11-Vue Router-å‰ç«¯è·¯ç”±å®ç°æ€è·¯

## â˜…æ¦‚è¿°

è·¯ç”±å™¨

1. è·¯ç”±æ˜¯ä»€ä¹ˆ

   ææ¸…æ¥šè¿™å‡ ä¸ªæ¦‚å¿µï¼š

   1. è·¯ç”±
   2. åˆ†å‘
   3. è·¯ç”±è¡¨
   4. é»˜è®¤è·¯ç”±
   5. 404 è·¯ç”± / ä¿åº•è·¯ç”±
   6. åµŒå¥—è·¯ç”±

2. hash æ¨¡å¼ï¼Ÿhistory æ¨¡å¼ï¼Ÿmemory æ¨¡å¼ï¼Ÿ

   1. hash <https://codesandbox.io/s/x3nxq950ko>
   2. history <https://codesandbox.io/s/oqjvqm6w05>
   3. memory <https://codesandbox.io/s/936269l69o>

3. [Vue-Router æºç ](https://github.com/vuejs/vue-router/blob/dev/dist/vue-router.js)

4. æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨

5. VueRouter çš„ä¸€äº› APIï¼ˆä¸‹èŠ‚è¯¾è®²ï¼‰

![ä½ å®¶é‡Œçš„è·¯ç”±å™¨](assets/img/2019-1-5-19-39-39.png)

## â˜…ç›®å½•

1. ä¸ä¼šå†™è·¯ç”±çš„å®ç°ä»£ç ï¼Œåªè®²å®ç°è·¯ç”±çš„æ€è·¯
2. è·¯ç”±æ˜¯ä»€ä¹ˆï¼Ÿ -> ç»™ä¸ªå›ç­”ï¼Œå¬å®Œæ–¹æ–¹çš„è®²è§£åï¼Œç»™å‡ºè‡ªå·±çš„æœ€ç»ˆç­”æ¡ˆ
3. äº†è§£ 3 ç§æ¨¡å¼çš„è·¯ç”±
4. vue-router çš„æºç ï¼Ÿ -> å¤§æ¦‚æœ‰ 2600 å¤šè¡Œï¼Ÿä¸»è¦è´¡çŒ®è€…æ˜¯å°¤é›¨æºªï¼Œè¯è¯´ï¼Œè¿™ä»£ç æ•°é‡å¤šå—ï¼Ÿï¼ˆ**åƒè¡Œçº§åˆ«çš„å¯ä»¥å»çœ‹ï¼Œä½†ä¸‡è¡Œçº§åˆ«çš„å°±ç®—äº†ï¼**ï¼‰ -> æ–¹æ–¹ä¼šæ¨èä¸€ç¯‡æ–‡ç« è®©ä½ å»çœ‹è¿™ä¸ªæºç å®ç°
5. æ­£åˆ™è¡¨è¾¾å¼ -> å¾ˆæœ‰ç”¨ï¼Œéœ€è¦åˆ»æ„å»å­¦ä¹ å®ƒï¼
6. vue-router API -> å¤§æ¦‚ç‡è‡ªå·±å»çœ‹æ–‡æ¡£ï¼

## â˜…è·¯ç”±æ˜¯ä»€ä¹ˆï¼Ÿ

> ç†è§£ã€Œè·¯ç”±ã€ï¼Œä»ç”Ÿæ´»æ¦‚å¿µå…¥æ‰‹

1ï¼‰ç®€å•ç†è§£ã€Œè·¯ç”±ã€æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸Šç½‘è·¯ç”±ï¼‰

æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­æ¥è§¦åˆ°çš„è·¯ç”±æœ‰å¾ˆå¤šï¼Œå¦‚ã€Œè·¯ç”±å™¨ã€ï¼Œä¸è¿‡ï¼Œç°åœ¨ä¼¼ä¹éƒ½ç”¨å…‰çŒ«äº†ï¼

> çŒ«å’Œè·¯ç”±å™¨çš„åŒºåˆ«ï¼š[Easy-Keyâ€”â€”ç§‘æ™®ï¼šçŒ«ã€è·¯ç”±å™¨å’Œäº¤æ¢æœºçš„åŒºåˆ«å’Œè”ç³» - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/31257745)

å®¶é‡Œæœ‰ä¸€ä¸ªæˆ–ä¸€ä¸ªä»¥ä¸Šçš„äººè¦ä¸Šç½‘å°±å¾—ç”¨åˆ°è·¯ç”±å™¨äº†ï¼

![è·¯ç”±å™¨](assets/img/2020-07-25-20-01-21.png)

> åˆ†å‘ï¼šåªè¦æ»¡è¶³ä¸€å¯¹å¤šçš„æƒ…å†µï¼Œå°±å«åšåˆ†å‘ï¼Œå³åˆ†åˆ«å‘é€åˆ°å„ä¸ªåœ°æ–¹

è·¯ç”±å™¨çš„ä¸»è¦ä½œç”¨æ˜¯åˆ†å‘è¯·æ±‚çš„ï¼Œåªè¦ä¸€ä¸ªä¸œè¥¿åˆ†å‘äº†è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯è·¯ç”±ï¼Œè€Œè¿™ä¸ªä¸œè¥¿å°±æ˜¯ã€Œè·¯ç”±å™¨ã€

ç¤ºä¾‹ï¼šå‘é€ä¸€ä¸ªè¯·æ±‚æŠ–éŸ³çš„ä¿¡å·ï¼Œè·¯ç”±å™¨å°±ä¼šåˆ†å‘å‡ºå»â€¦â€¦

è¯è¯´ï¼Œå¦‚æœé¢è¯•å®˜é—®ä½ ã€Œä»€ä¹ˆæ˜¯è·¯ç”±ï¼Ÿã€ï¼Œä½ ä¼šæ€ä¹ˆå›ç­”ï¼Ÿ

> åˆ†å‘ã€Œè¯·æ±‚ã€çš„ä¸œè¥¿æˆ–è€…åˆ†å‘ã€Œè¯·æ±‚ã€çš„å¯¹è±¡æ˜¯ã€Œè·¯ç”±å™¨ã€ï¼ˆå™¨å°±æ˜¯å™¨ç‰©ä¹‹æ„ï¼‰ï¼Œè€Œ**åˆ†å‘ã€Œè¯·æ±‚ã€å°±æ˜¯ã€Œè·¯ç”±ã€**

ç„¶è€Œï¼Œé¢è¯•å®˜é—®çš„æ˜¯ã€Œå‰ç«¯è·¯ç”±ã€ï¼Œè€Œæˆ‘ä»¬å›ç­”çš„æ˜¯ã€Œä¸Šç½‘è·¯ç”±ã€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¹æˆ‘ä»¬äº†è§£åˆ°çš„ã€Œä¸Šç½‘è·¯ç”±ã€ç»†åŒ–æˆã€Œå‰ç«¯è·¯ç”±ã€

2ï¼‰ã€Œåœæ­¢å­¦ä¹ æ¡†æ¶ã€

æ–¹æ–¹ç¿»è¯‘äº†ä¸€ç¯‡æ–‡ç« â€”â€”åœæ­¢å­¦ä¹ æ¡†æ¶

è¯„è®ºä¸­æœ‰ä¸€äº›å¾ˆå…¸å‹çš„æ€ç»´ï¼š

> ä¸å­¦æ¡†æ¶ï¼Ÿè°ä¼šè¦ä½ ï¼Ÿç°åœ¨çš„å‰ç«¯ä¸å°±æ˜¯å­¦æ¡†æ¶çš„å—ï¼Ÿä¸ºå•¥è¦åœæ­¢å­¦ä¹ æ¡†æ¶ï¼Ÿæˆ‘å¾—ç”¨ 100% çš„æ—¶é—´æ¥å­¦ä¹ æ¡†æ¶æ‰è¡Œâ€¦â€¦

æ–¹æ–¹æ˜¯å¦‚ä½•å­¦ä¹  router çš„ï¼Ÿ

1. ä¸çœ‹ vue router æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå…ˆå»çœ‹æœ‰å…³è·¯ç”±çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¯•ç«Ÿé™¤äº† vue æœ‰ router ä»¥å¤–ï¼Œè¿˜æœ‰ reactã€angular éƒ½æœ‰ï¼Œæ‰€ä»¥å¦‚æœä½ ä¸å­¦åŸºç¡€çŸ¥è¯†çš„è¯ï¼Œé‚£ä¹ˆè¿™å°±æ„å‘³ç€ä½ è¦å­¦ä¹ ä¸‰ç§è·¯ç”± API -> è¿™å°±åƒæ˜¯**å…ˆå»äº†è§£ã€Œæ°´æœã€ï¼Œå†å»äº†è§£ã€Œæ¡ƒå­ã€æå­ã€æ¢¨å­ã€** æˆ–è€…è¯´å°±åƒæ˜¯äº§å“é‡Œçš„ã€Œ**MVP**ã€æ¦‚å¿µä¸€æ ·ï¼Œå…ˆå°è¯•æä¸ªåŸå‹ï¼Œå†å»è¿­ä»£ä¼˜åŒ–â€¦â€¦
2. åˆ°ç»´åŸºç™¾ç§‘æŸ¥ã€Œè·¯ç”±ã€æœ€æœ€åŸºç¡€ã€æœ€æœ€åŸå§‹çš„å«ä¹‰ -> å¾—åˆ°ä¸€äº›ç›¸å…³æ¦‚å¿µï¼šã€Œåˆ†å‘ã€+ã€Œè·¯ç”±å™¨ã€ï¼ˆç¡¬ä»¶ï¼Œä¸ç”¨çœ‹ï¼‰+ã€Œè·¯ç”±è¡¨ã€ï¼ˆå­˜å‚¨è·¯å¾„çš„è¡¨ï¼Œæ¯ä¸ªæ¡†æ¶çš„ router å®ç°éƒ½ä¼šæœ‰è·¯ç”±è¡¨ï¼‰+ã€Œè·¯ç”±å½¢å¼ã€ï¼ˆå¦‚ä½•ä¼ æ’­ä¿¡æ¯ï¼‰

> route æ˜¯ã€Œè·¯çº¿ã€ï¼Œ router æ˜¯è·¯ç”±å™¨ï¼Œå³è·¯ç”±å™¨å¯¹è±¡â€¦â€¦

3ï¼‰å‰ç«¯è·¯ç”±

> codesanbox åˆ›å»ºä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡»ã€Œæœ‰é¢œè‰²çš„ box ã€æ¥åˆ›å»º -> åŸç”Ÿ JSï¼ˆlogo é»„è‰²ï¼‰ã€Reactï¼ˆlogo è“è‰²ï¼‰ã€Vueï¼ˆlogo ç»¿è‰²ï¼‰

éœ€æ±‚ï¼š

![å‰ç«¯è·¯ç”±éœ€æ±‚](assets/img/2020-07-26-00-04-46.png)

ä»£ç å®ç°ï¼š[æ•ˆæœ](https://ppambler.github.io/vue-demo-2/router/index1.html)ã€[æºç ](https://github.com/ppambler/vue-demo-2/blob/master/router/index1.html)

![æ•ˆæœå›¾ç¤º](assets/img/2020-07-27-01-10-45.png)

> ä»£ç å†™å¾—ä¸å¥½çœ‹â€¦â€¦

## â˜…ä¼˜åŒ–ä»£ç 

1ï¼‰ä»ä¸Šä¸ªä¾‹å­é‡Œè¾¹å­¦åˆ°çš„æ¦‚å¿µ

* è·¯ç”±
* `hash(#1)`

2ï¼‰è¿½åŠ é¢å¤–åŠŸèƒ½

1ã€é»˜è®¤è·¯ç”±

> å³é¡µé¢ä¸€æ‰“å¼€ `number` é»˜è®¤å°±æ˜¯ `1` -> `number = number || 1` -> `url` åç¼€æ²¡æœ‰ `#xx` ï¼Œ `div#app` é‡Œè¾¹æ˜¾ç¤ºçš„å°±æ˜¯é»˜è®¤è·¯ç”±è¿‡æ¥çš„ç•Œé¢ï¼

![é»˜è®¤è·¯ç”±](assets/img/2020-07-27-11-12-56.png)

2ã€404 è·¯ç”±/ä¿åº•è·¯ç”±

> ä¿è¯ç”¨æˆ·æ€»æ˜¯èƒ½å¤Ÿçœ‹åˆ°ä¸€ä¸ªä¸œè¥¿ï¼Œä¸èƒ½å‡ºç°æ„å¤–çš„æƒ…å†µ

![404 è·¯ç”±](assets/img/2020-07-27-11-56-35.png)

3ã€åµŒå¥—è·¯ç”±

éœ€æ±‚ï¼š

![éœ€æ±‚](assets/img/2020-07-27-12-07-22.png)

ä»£ç æœ‰ç‚¹éº»çƒ¦ï¼Œä¸‹ä¸ª `â˜…` ä¼šè®²åˆ°ï¼

3ï¼‰ä»£ç ä¼˜åŒ–

1. é‡å¤ä»£ç å‡½æ•°æå– -> å‡½æ•°å `x` ï¼ˆæƒ³ä¸å‡ºåå­—ï¼Œå°±ç”¨è¿™ä¸ª `x` ï¼Œè€Œ `x` çš„æ„æ€æ˜¯è¡¨ç¤ºå‡½æ•°ä»£ç å†™å®Œä¹‹åä¸€å®šä¼šä¿®æ”¹çš„ï¼‰ -> çœ‹åˆ°å‡½æ•°ä½“çš„é€»è¾‘â€”â€”æ ¹æ®ä½ æƒ³å»çš„åœ°æ–¹ï¼Œå±•ç¤ºä½ çš„ç•Œé¢ï¼Œå³ä»ä¸€ä¸ªæºåœ°å€ï¼Œåˆ°è¾¾ç›®çš„åœ°ï¼Œè€Œè¿™å°±æ˜¯**è·¯ç”±** -> æ‰€ä»¥å‡½æ•°çš„åå­—æ˜¯ã€Œ `route` ã€

``` html
<a href="#1">go to 1</a>
<a href="#2">go to 2</a>
<a href="#3">go to 3</a>
<a href="#4">go to 4</a>
<div id="app"></div>
<div id="div1" style="display: none;">1</div>
<div id="div2" style="display: none;">2</div>
<div id="div3" style="display: none;">3</div>
<div id="div4" style="display: none;">4</div>
<div id="div404" style="display: none;">ä½ è¦æ‰¾çš„å†…å®¹è¢«ç‹—åƒäº†</div>
```

``` js
function route() {
  // è·å– hash
  let number = window.location.hash.substr(1)

  // æ‰¾åˆ°å‘ä½
  let app = document.querySelector('#app')

  // é»˜è®¤è·¯ç”±
  number = number || 1

  // é‡ç½®ç•Œé¢
  if (app.children.length > 0) {
    // æ—§ç•Œé¢éšè—
    app.children[0].style.display = "none"
    // æ—§ç•Œé¢å›åˆ°åŸå¤„
    document.body.appendChild(app.children[0])
  }

  // è·å–ç•Œé¢
  let div = document.querySelector( `#div${number}` )
  if (!div) {
    div = document.querySelector( `#div404` )
  }
  div.style.display = "block"

  // å±•ç¤ºç•Œé¢ or æ–°ç•Œé¢å…¥å‘
  app.appendChild(div)
}

route()

window.addEventListener('hashchange', () => {
  console.log('hash å˜äº†')
  route()
})
```

---

æ¥ä¸‹æ¥çœ‹çœ‹ã€Œè·¯ç”±è¡¨ã€

## â˜…è·¯ç”±è¡¨

1ï¼‰ä¸ºå•¥éœ€è¦è·¯ç”±è¡¨ï¼Ÿ

`route` å‡½æ•°é‡Œè¾¹ï¼Œå‡­å•¥å°±åªæœ‰ `1/2/3/4` è¿™ 4 ä¸ª hashï¼Ÿéš¾é“å°±ä¸èƒ½è‡ªå®šä¹‰å—ï¼Ÿå‡­å•¥ `1` å°±æ˜¯ `div1` å‘¢ï¼Ÿæˆ‘ `one` æ˜¯ `div1` ä¸è¡Œä¹ˆï¼Ÿ

> ç›®å‰ `route` å‡½æ•°é‡Œçš„è§„åˆ™æ˜¯å¾ˆå¥‡æ€ªçš„ï¼Œå³åªèƒ½æ ¹æ® `#div${number}` è¿™æ ·çš„è§„åˆ™æ¥è·å–ç›¸åº”çš„ç•Œé¢ï¼Œå¦‚ `#1 -> div1` ï¼Œä¸ºå•¥å°±ä¸èƒ½æ˜¯ `#1 -> div666` å‘¢ï¼Ÿå‡­å•¥åªèƒ½æ˜¯ `div1` è¿™ä¸ªç•Œé¢ï¼Ÿæˆ‘ä½¿ç”¨ä½ è¿™ä¸ª `route` å‡½æ•°ï¼Œå‡­å•¥å¿…é¡»è¦æˆ‘åœ¨é¡µé¢ä¸­å†™ä¸ªå« `#div1` çš„ `div` ï¼Ÿ

2ï¼‰è¡¨é©±åŠ¨ç¼–ç¨‹

> `div` -> ç•Œé¢åœ¨å†…å­˜ä¸­åˆ›å»º

``` js
const div1 = document.createElement('div')
div1.innerHTML = '1'
const div2 = document.createElement('div')
div2.innerHTML = '2'
const div3 = document.createElement('div')
div3.innerHTML = '3'
const div4 = document.createElement('div')
div4.innerHTML = '4'

const routeTable = {
  '1': div1,
  '2': div2,
  '3': div3,
  '4': div4
}

// route é‡Œè¾¹ï¼š
// è·å–ç•Œé¢ -> number -> stringï¼Œå³ä¾¿ number ä¸æ˜¯ string ä¹Ÿä¼šè‡ªåŠ¨è½¬æˆ string
let div = routeTable[number]
```

å…¶å®ï¼Œè·¯ç”±æ˜¯å¾ˆç®€å•çš„ï¼Œåªè¦ä½ æŠŠåŸºç¡€çš„ä¸œè¥¿ç†è§£é€äº†ï¼Œå°±ä¸ç”¨ç®¡æ˜¯ Vue ã€React ã€Angularï¼Œå› ä¸ºå®ƒä»¬çš„å®ç°æ€è·¯è‚¯å®šæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æä¾›çš„ API ä¸ä¸€æ ·ç½¢äº†ï¼

3ï¼‰åµŒå¥—è·¯ç”±

éœ€æ±‚ï¼š

![éœ€æ±‚](assets/img/2020-07-27-20-05-44.png)

ç®€å•æ¥è¯´ï¼š

* `1/1` -> å» `1.1` è¿™ä¸ªå­ç•Œé¢

åœ¨è·¯ç”±é‡Œè¾¹å†åˆ†ä¸€ä¸ªè·¯ç”±ï¼Œè€Œè¿™ä¸ªè·¯ç”±å°±æ˜¯ã€Œå­è·¯ç”±ã€æˆ–ã€ŒåµŒå¥—è·¯ç”±ã€

> è·¯ç”±å³æ˜¯è·¯çº¿

æ€ä¹ˆåšï¼Ÿ

> `route` å‚æ•°æ˜¯ `container` -> æœ¬æ¥å« rootï¼Œç”±äºå‡½æ•°å route ä¸ root å‘éŸ³è¿‡äºç›¸ä¼¼å°± GG æ‰äº†â€¦â€¦

æ€è·¯ï¼š

![åµŒå¥—è·¯ç”±æ€è·¯](assets/img/2020-07-27-20-22-02.png)

æˆ‘çœ‹äº†ä¸€ä¸‹ Vue Router çš„åµŒå¥—è·¯ç”±æ¦‚å¿µï¼š

> æ–‡æ¡£ï¼š[åµŒå¥—è·¯ç”± - Vue Router](https://router.vuejs.org/zh/guide/essentials/nested-routes.html)

å‘ç°æ ¹è·¯ç”±çš„è§†å›¾ï¼Œä¸å­è·¯ç”±çš„è§†å›¾ä¸€èµ·çš„ï¼Œå°±åƒæ˜¯è¿™æ ·ï¼š

``` 
/user/foo/profile                     /user/foo/posts
+------------------+                  +-----------------+
| User             |                  | User            |
| +--------------+ |                  | +-------------+ |
| | Profile      | |  +------------>  | | Posts       | |
| |              | |                  | |             | |
| +--------------+ |                  | +-------------+ |
+------------------+                  +-----------------+
```

æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ª `div` åµŒå¥—ç€ä¸€ä¸ª `div` -> æˆ‘ä¹‹å‰ä»¥ä¸ºæ˜¯è¿™æ ·çš„ï¼š

![åµŒå¥—è·¯ç”±](assets/img/2020-07-27-20-34-07.png)

> é‚£ä¸ª `true` æ ‡è¯†çš„æ‰æ˜¯å¤§å®¶è®¤ä¸ºçš„åµŒå¥—è·¯ç”±çš„ç»“æœâ€¦â€¦è€Œä¸æ˜¯é‚£ä¸ª `false`ï¼ˆæˆ‘åŸå…ˆä»¥ä¸ºéœ€æ±‚æ˜¯ç±»ä¼¼`false`è¿™æ ·çš„ï¼‰

æ–¹æ–¹æ˜¯è¿™æ ·å®ç°çš„ï¼š

``` js
const div11 = document.createElement('div')
div1.innerHTML = '1.1'
const div12 = document.createElement('div')
div2.innerHTML = '1.2'
const div13 = document.createElement('div')
div3.innerHTML = '1.3'

// å†å®šä¹‰ä¸€ä¸ªå­è·¯ç”±è¡¨
const route1Table = {
  "1/1": div11,
  "1/2": div12,
  "1/3": div13
}

// container -> root -> å¦‚æœæ˜¯ #1/2ï¼Œé‚£ä¹ˆ 1 å°±æ˜¯ root or container
function route(container) {
  // â€¦â€¦
}
```

---

è‡³æ­¤ï¼Œå…³äºè·¯ç”±å‡ ä¸ªé‡è¦çš„æ¦‚å¿µï¼ŒåŸºæœ¬ä¸Šå·²ç»è®²æ¸…æ¥šäº†ï¼Œæ¥ä¸‹æ¥ï¼Œå°±æ¥çœ‹çœ‹ `hash` ã€ `history` ã€ `memory` çš„åŒºåˆ«

## â˜…History æ¨¡å¼

> ä¹‹å‰è®²äº†è·¯ç”±æ˜¯ä»€ä¹ˆï¼Œä»¥åŠè·¯ç”±ç›¸å…³çš„æ¦‚å¿µ
> 
> æ–‡æ¡£ï¼š[HTML5 History æ¨¡å¼ - Vue Router](https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90)

1ï¼‰ä¸ºå•¥ä¸ç”¨ `hash` æ¨¡å¼ï¼Ÿ

æˆ‘ä»¬çŸ¥é“`hash`åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½åšå‰ç«¯è·¯ç”±â€¦â€¦

ä½†è¿™ç§å§¿åŠ¿ï¼Œå¯¹ SEO ä¸å‹å¥½ï¼Œä¹Ÿå°±æ˜¯è¯´ã€ŒæœåŠ¡å™¨æ”¶ä¸åˆ°hashï¼Œå†…å®¹æ˜¯ä¸ä¼šè¢«æœç´¢å¼•æ“æ”¶å½•çš„ã€

![SEO](assets/img/2020-07-28-18-20-11.png)

ä¸è¿‡ï¼Œè¿™ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œgoogleåšäº†å¤„ç†ï¼Œå¯ä»¥å¯¹hashåšä¸ªSEOå¤„ç†ï¼Œå½“ç„¶ï¼Œè¿™å¾—è¦ä½ å¯¹æœåŠ¡å™¨åšä¸€äº›é…ç½®

åšæ³•ï¼š

hashbang -> `#!xxx` -> å¸¦`!`å°±è¡Œäº†â€¦â€¦ -> ä¸æ¨èè¿™æ ·åšâ€¦â€¦

> æˆ‘è§‰å¾—ä¸ç”¨`hash`æ¨¡å¼æ˜¯å› ä¸º`#`å¤ªä¸‘äº†ï¼ -> ç”¨`history`æ¨¡å¼çš„è¯ï¼Œå¯ä»¥ç›´æ¥`/1`è¿™æ ·è·å–ç•Œé¢â€¦â€¦è€Œä¸æ˜¯`#1`è¿™æ ·

2ï¼‰`history`æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ

ç”¨æˆ·éšæ„è¾“å…¥ä¸€ä¸ªurlï¼Œå“åº”å›æ¥çš„æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„é¡µé¢ï¼ˆå¦‚é¦–é¡µï¼‰ï¼Œè€Œä¸æ˜¯404é¡µé¢ï¼ˆ404é¡µé¢æ˜¯æ— ç”¨çš„ï¼‰ï¼

æ‰€ä»¥`history`æ¨¡å¼æ˜¯ï¼š

> åç«¯å°†æ‰€æœ‰å‰ç«¯è·¯ç”±éƒ½æ¸²æŸ“åˆ°åŒä¸€é¡µé¢ï¼

ç¼ºç‚¹ï¼šIE8åŠä»¥ä¸‹æ”¯æŒ -> å¯å¿½ç•¥ä¸è®¡ï¼

3ï¼‰åšæ³•

1. è·¯ç”±è¡¨çš„`key`å˜æˆ`/1`è¿™æ ·äº†
2. é˜»æ­¢`a`é“¾æ¥çš„é»˜è®¤è¡Œä¸º -> ä½¿ç”¨`forâ€¦â€¦of`è¿­ä»£æ‰€æœ‰`a`DOMå¯¹è±¡
3. ä½¿ç”¨`history`APIï¼ˆ`history.pushState(obj,'page 2','xx.html')`ï¼‰ -> åœ¨ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹ï¼Œæ›´æ”¹URL 
4. ç›‘å¬`path`çš„æ”¹å˜ï¼Œæ›´æ”¹ç•Œé¢ -> ç„¶è€Œæ²¡æœ‰ç›¸åº”çš„äº‹ä»¶ç›‘å¬æ–¹æ³• -> å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç‚¹å‡»`a`å°±æ‰§è¡Œ`callback`

`history`æ¨¡å¼ä¸ºå•¥è¦è®©æ‰€æœ‰çš„é¡µé¢æŒ‡å‘åŒä¸€ä¸ªé¡µé¢å‘¢ï¼Ÿ

> å› ä¸ºç”¨æˆ·å–œæ¬¢åˆ·æ–°ï¼Œä¸ç„¶`/66`è¿™æ ·å­˜åœ¨çš„è·¯å¾„å°±æ˜¯404é¡µé¢äº†ï¼

> æ„Ÿè§‰ä¹‹æ‰€ä»¥ç”¨`history`æ¨¡å¼æ˜¯å› ä¸ºè¦ `fuck` æ‰ 404 é¡µé¢ï¼è€Œä¸”ä¹Ÿæœ‰SEOï¼å› ä¸ºè¯·æ±‚æœåŠ¡å™¨å°±æ˜¯å¸¦`/1`çš„ï¼è¿˜æœ‰å°±æ˜¯ç”¨æˆ·ä¸éœ€è¦åˆ·æ–°äº†â€¦â€¦

æ³¨æ„ï¼Œåç«¯æ˜¯éœ€è¦é…ç½®çš„ï¼š

![åç«¯é…ç½®](assets/img/2020-07-29-00-08-35.png)

---

Qï¼š`forâ€¦â€¦of`ï¼Ÿ

åœ¨å¯è¿­ä»£å¯¹è±¡ï¼ˆåŒ…æ‹¬ `Array`ï¼Œ`Map`ï¼Œ`Set`ï¼Œ`String`ï¼Œ`TypedArray`ï¼Œ`arguments` å¯¹è±¡ç­‰ç­‰ï¼‰ä¸Šåˆ›å»ºä¸€ä¸ªè¿­ä»£å¾ªç¯ï¼Œè°ƒç”¨è‡ªå®šä¹‰è¿­ä»£é’©å­ï¼Œå¹¶ä¸ºæ¯ä¸ªä¸åŒå±æ€§çš„å€¼æ‰§è¡Œè¯­å¥

ç®€å•æ¥è¯´ï¼Œç´¢å¼•æœ‰`0ã€1ã€2â€¦â€¦`çš„å³å¯è¿­ä»£ï¼Œè€Œåƒ`xxx`è¿™æ ·çš„å¯¹è±¡å±æ€§æ˜¯æ— æ³•è¿­ä»£çš„ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šè¿­ä»£ç»§æ‰¿çš„â€¦â€¦å³ä¸ä¼šè¿­ä»£åŸå‹é“¾ä¸Šçš„â€¦â€¦

â¹ï¼š[for...of - JavaScript - MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/for...of)

Qï¼šè¯æ˜ JS ç”Ÿæ•ˆï¼Ÿ

å¯¹ JS æ–‡ä»¶ `console.log('fuck')`

Qï¼š`http://www.baidu.com`ï¼Ÿ

è¡¨é¢ä¸Šçœ‹æ˜¯è¿™æ ·ï¼Œå…¶å®å‘çš„è¯·æ±‚æ˜¯`http://www.baidu.com/`è¿™æ ·çš„ï¼

Qï¼šå¦‚ä½•è®©å¯¹è±¡çš„keyå€¼æ˜¯å˜é‡ï¼Ÿ

å§¿åŠ¿ä¸€ï¼š

``` js
const username = "name";
const obj = {
  [username]:"king123"
}
console.log(obj.name); //output-> king123
```

å§¿åŠ¿äºŒï¼š

``` js
const username = "name";

const obj = {};
obj[username] = "king123";

console.log(obj.name); //output-> king123
console.log(obj[username]) // output -> king123
```

æ‰€ä»¥å¯æœ‰ï¼š

``` js
const baseUrl = '/router/'

let hashTable = {
  '1': div1,
  '2': div2,
  '3': div3,
  '4': div4
}

function createRouteTable(baseUrl, hashTable) {
  let obj = {}
  for (let key in hashTable) {
    obj[baseUrl + key] = hashTable[key]
  }
  return obj
}

const routeTable = createRouteTable(baseUrl, hashTable)
console.log(routeTable)
```

ç»“æœå¾ˆå¥‡æ€ªï¼š

![key](assets/img/2020-07-29-00-51-45.png)

> ä¼¼ä¹æ˜¯é‚£ä¸ª value å€¼çš„æ•ˆæœï¼ -> å³é‚£ä¸ª `div` DOM å¯¹è±¡

â¹ï¼š[How to use variable as an Object key in JavaScript - Reactgo](https://reactgo.com/javascript-variable-object-key/)

â¹ï¼š[JSON.stringify()](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)

---

## â˜…`hash`æ¨¡å¼å’Œ`history`æ¨¡å¼å¯¹æ¯”
















